-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;

CREATE TABLE IF NOT EXISTS public.employees
(
    emp_id bigserial NOT NULL,
    first_name character varying(50) NOT NULL,
    surname character varying(50) NOT NULL,
    gender character varying(10),
    address character varying(150),
    email character varying(225),
    depart_id bigserial,
    role_id bigserial,
    salary_id bigserial,
    overtime_id bigserial,
    PRIMARY KEY (emp_id)
);

CREATE TABLE IF NOT EXISTS public.department
(
    depart_id bigserial NOT NULL,
    depart_name character varying(50) NOT NULL,
    depart_city character varying(50),
    PRIMARY KEY (depart_id)
);

CREATE TABLE IF NOT EXISTS public.roles
(
    role_id bigserial NOT NULL,
    role character varying(50),
    PRIMARY KEY (role_id)
);

CREATE TABLE IF NOT EXISTS public.salaries
(
    salary_id bigserial NOT NULL,
    salary bigint,
    PRIMARY KEY (salary_id)
);

CREATE TABLE IF NOT EXISTS public.overtime_hours
(
    overtime_id bigserial NOT NULL,
    overtime_hours numeric,
    PRIMARY KEY (overtime_id)
);

ALTER TABLE IF EXISTS public.employees
    ADD CONSTRAINT depart_id FOREIGN KEY (depart_id)
    REFERENCES public.department (depart_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.employees
    ADD CONSTRAINT role_id FOREIGN KEY (role_id)
    REFERENCES public.roles (role_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.employees
    ADD CONSTRAINT salary_id FOREIGN KEY (salary_id)
    REFERENCES public.salaries (salary_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.employees
    ADD CONSTRAINT overtime_id FOREIGN KEY (overtime_id)
    REFERENCES public.overtime_hours (overtime_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;



INSERT INTO employees (
	first_name, 
	surname,
	gender, 
	address, 
	email,
	depart_id,
	role_id,
	salary_id,
	overtime_id)
VALUES	
	('Jane', 'Doe', 'F', '167 Prince Blvd, Bedford', 'janed@one.in', 18, 29, 49, 64),
	('TJ', 'The One', 'M', '1 Ndaba Str, TJ Estate', '1tj@one.in', 11, 20, 41, 63),
	('Peter', 'Stark', 'M', '5 Thami Str, TJ Estate', 'petestark@one.in', 13, 25, 42, 62),
	('Toney', 'Parker', 'M','Unit 3, James Ave, Thamiwood', 'toney@one.in', 15, 23, 43, 61);


INSERT INTO department (
	depart_id,
	depart_name, 
	depart_city)
VALUES 
	(18, 'Music', 'Thembisa'),
	(11, 'VC', 'Silicon Valley'),
	(13, 'Accounting', 'Peit Retief'),
	( 15, 'Mining', 'Durban');

INSERT INTO	overtime_hours (overtime_id, overtime_hours)
VALUES 
	(64,1),
	(63,5),
	(62,2),
	(61, 4.5);
	
INSERT INTO roles (role_id, role)
VALUES 
	(29, 'Intern'),
	(20, 'CTO'),
	(25, 'Supervisor'),
	(23, 'COO');
	
INSERT INTO salaries (salary_id, salary)
VALUES 
	(49, 10000),
	(41, 120000),
	(42, 55000),
	(43, 82000);

SELECT * FROM public.employees;
SELECT * FROM public.department;
SELECT * FROM public.roles;
SELECT * FROM public.salaries;
SELECT * FROM public.overtime_hours;

--left join department name, job title, salary figure and overtime hours
SELECT first_name, surname, depart_name, role, salary, overtime_hours
From employees LEFT JOIN department 
 ON employees.depart_id = department.depart_id
 LEFT JOIN roles 
 ON employees.role_id = roles.role_id
 LEFT JOIN salaries 
 ON employees.salary_id = salaries.salary_id
 LEFT JOIN overtime_hours 
 ON employees.overtime_id =overtime_hours.overtime_id

	